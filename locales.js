const TRANSLATIONS = {
    en: {
        // Auth
        "welcome": "Welcome",
        "login_title": "Login to your account",
        "signup_title": "Create new account",
        "username_ph": "Enter username",
        "password_ph": "Enter password",
        "login_btn": "Login",
        "signup_btn": "Sign Up",
        "no_account": "No account?",
        "has_account": "Have an account?",
        "lang_select": "Language",

        // Sidebar
        "profile_title": "Your Profile",
        "personality_type": "Personality Type",
        "analysis": "Analysis in progress...",
        "current_level": "Current Level",
        "core_stats": "Core Statistics",
        "dashboard_link": "Dashboard âžœ",

        // Chat
        "chat_header": "AI Chat RPG",
        "lvl": "Lvl",
        "xp": "XP",
        "focus": "Focus",
        "input_ph": "Ask me anything...",
        "send": "Send",
        "chat_nav": "Chat",
        "profile_nav": "Profile",
        "dash_nav": "Dashboard",
        "logout_nav": "Logout",
        "initial_greeting": "Greetings, Traveler! I am your AI Guide. Speak with me to earn XP, level up, and unlock your true potential. ðŸŒŒ",

        // Dashboard
        "dash_title": "Dashboard",
        "back_chat": "Back to Chat",
        "arena_btn": "1v1 Arena",
        "traveler": "Traveler",
        "streak": "Streak",
        "energy": "Energy",
        "stats_tab": "Statistics",
        "badges_tab": "Badges",
        "quests_tab": "Daily Quests",
        "weekly_tab": "Weekly Quests",
        "events_tab": "Events",
        "live_stats": "Live Stats",
        "refresh": "Refresh",

        // Stats
        "health": "Health",
        "discipline": "Discipline",
        "productivity": "Productivity",
        "consistency": "Consistency",
        "creativity": "Creativity",
        "kindness": "Kindness",
        "awareness": "Awareness",

        // Stats Card Headers & Labels
        "current_level_header": "Current Level",
        "hero_title_label": "Title",
        "core_stats_section": "Core Stats",
        "activity_section": "Activity",
        "next_title": "Next",
        "total_msgs": "Total Msgs",
        "total_xp": "Total XP",

        // Quests & Events
        "reward": "Reward",
        "current_potential": "Current Potential",
        "accept_challenge": "Accept Challenge",
        "solve": "Solve",
        "hint": "Hint",
        "hint_deduct": "Hint (-50 XP)",
        "hint_deduct_more": "Hint (-75 XP)",
        "answer_placeholder": "Type your answer...",
        "anomaly_cleared": "Anomaly Cleared!",
        "incorrect_coordinate": "Incorrect coordinate. Signal lost.",

        // General
        "loading": "Loading...",
        "level_up": "Level Up!",
        "claim_rewards": "Claim Rewards",
        "growing_stronger": "You are growing stronger, Traveler."
    },
    ru: {
        // Auth
        "welcome": "Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ",
        "login_title": "Ð’Ð¾Ð¹Ñ‚Ð¸ Ð² Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚",
        "signup_title": "Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚",
        "username_ph": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ",
        "password_ph": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
        "login_btn": "Ð’Ð¾Ð¹Ñ‚Ð¸",
        "signup_btn": "Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ",
        "no_account": "ÐÐµÑ‚ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°?",
        "has_account": "Ð•ÑÑ‚ÑŒ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚?",
        "lang_select": "Ð¯Ð·Ñ‹Ðº",

        // Sidebar
        "profile_title": "Ð’Ð°Ñˆ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ",
        "personality_type": "Ð¢Ð¸Ð¿ Ð»Ð¸Ñ‡Ð½Ð¾ÑÑ‚Ð¸",
        "analysis": "Ð˜Ð´ÐµÑ‚ Ð°Ð½Ð°Ð»Ð¸Ð·...",
        "current_level": "Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ",
        "core_stats": "Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸",
        "dashboard_link": "Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´ âžœ",

        // Chat
        "chat_header": "AI Chat RPG",
        "lvl": "Ð£Ñ€.",
        "xp": "ÐžÐ¿Ñ‹Ñ‚",
        "focus": "Ð¤Ð¾ÐºÑƒÑ",
        "input_ph": "Ð¡Ð¿Ñ€Ð¾ÑÐ¸ Ð¼ÐµÐ½Ñ Ð¾ Ñ‡ÐµÐ¼-Ð½Ð¸Ð±ÑƒÐ´ÑŒ...",
        "send": "ÐžÑ‚Ð¿Ñ€.",
        "chat_nav": "Ð§Ð°Ñ‚",
        "profile_nav": "ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ",
        "dash_nav": "Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´",
        "logout_nav": "Ð’Ñ‹Ñ…Ð¾Ð´",
        "initial_greeting": "ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽ, ÐŸÑƒÑ‚Ð½Ð¸Ðº! Ð¯ Ñ‚Ð²Ð¾Ð¹ AI Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ð½Ð¸Ðº. Ð“Ð¾Ð²Ð¾Ñ€Ð¸ ÑÐ¾ Ð¼Ð½Ð¾Ð¹, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÑŒ Ð¾Ð¿Ñ‹Ñ‚, Ð¿Ð¾Ð²Ñ‹ÑˆÐ°Ñ‚ÑŒ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð¸ Ñ€Ð°ÑÐºÑ€Ñ‹Ñ‚ÑŒ ÑÐ²Ð¾Ð¹ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð». ðŸŒŒ",

        // Dashboard
        "dash_title": "Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´",
        "back_chat": "ÐÐ°Ð·Ð°Ð´ Ð² Ñ‡Ð°Ñ‚",
        "arena_btn": "ÐÑ€ÐµÐ½Ð° 1x1",
        "traveler": "ÐŸÑƒÑ‚Ð½Ð¸Ðº",
        "streak": "Ð¡Ñ‚Ñ€Ð¸Ðº",
        "energy": "Ð­Ð½ÐµÑ€Ð³Ð¸Ñ",
        "stats_tab": "Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",
        "badges_tab": "Ð—Ð½Ð°Ñ‡ÐºÐ¸",
        "quests_tab": "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ",
        "weekly_tab": "Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ðµ",
        "events_tab": "Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ",
        "live_stats": "Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",
        "refresh": "ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ",

        // Stats
        "health": "Ð—Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ",
        "discipline": "Ð”Ð¸ÑÑ†Ð¸Ð¿Ð»Ð¸Ð½Ð°",
        "productivity": "ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ",
        "consistency": "Ð¡Ñ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ",
        "creativity": "ÐšÑ€ÐµÐ°Ñ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ",
        "kindness": "Ð”Ð¾Ð±Ñ€Ð¾Ñ‚Ð°",
        "awareness": "ÐžÑÐ¾Ð·Ð½Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ",

        // Stats Card Headers & Labels
        "current_level_header": "Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ",
        "hero_title_label": "Ð¢Ð¸Ñ‚ÑƒÐ»",
        "core_stats_section": "Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ñ…Ð°Ñ€-ÐºÐ¸",
        "activity_section": "ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ",
        "next_title": "Ð¡Ð»ÐµÐ´",
        "total_msgs": "Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹",
        "total_xp": "Ð’ÑÐµÐ³Ð¾ XP",

        // Quests & Events
        "reward": "ÐÐ°Ð³Ñ€Ð°Ð´Ð°",
        "current_potential": "ÐÐ°Ð³Ñ€Ð°Ð´Ð°",
        "accept_challenge": "ÐŸÑ€Ð¸Ð½ÑÑ‚ÑŒ Ð²Ñ‹Ð·Ð¾Ð²",
        "solve": "Ð ÐµÑˆÐ¸Ñ‚ÑŒ",
        "hint": "ÐŸÐ¾Ð´ÑÐºÐ°Ð·ÐºÐ°",
        "hint_deduct": "ÐŸÐ¾Ð´ÑÐºÐ°Ð·ÐºÐ° (-50 XP)",
        "hint_deduct_more": "ÐŸÐ¾Ð´ÑÐºÐ°Ð·ÐºÐ° (-75 XP)",
        "answer_placeholder": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¾Ñ‚Ð²ÐµÑ‚...",
        "anomaly_cleared": "ÐÐ½Ð¾Ð¼Ð°Ð»Ð¸Ñ ÑƒÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð°!",
        "incorrect_coordinate": "ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ðµ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹. Ð¡Ð¸Ð³Ð½Ð°Ð» Ð¿Ð¾Ñ‚ÐµÑ€ÑÐ½.",

        // General
        "loading": "Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...",
        "level_up": "ÐÐ¾Ð²Ñ‹Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ!",
        "claim_rewards": "Ð—Ð°Ð±Ñ€Ð°Ñ‚ÑŒ Ð½Ð°Ð³Ñ€Ð°Ð´Ñƒ",
        "growing_stronger": "Ð¢Ñ‹ ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸ÑˆÑŒÑÑ ÑÐ¸Ð»ÑŒÐ½ÐµÐµ, ÐŸÑƒÑ‚Ð½Ð¸Ðº."
    },
    am: {
        // Auth
        "welcome": "Ô²Õ¡Ö€Õ« Õ£Õ¡Õ¬Õ¸Ö‚Õ½Õ¿",
        "login_title": "Õ„Õ¸Ö‚Õ¿Ö„ Õ£Õ¸Ö€Õ®Õ¥Õ¬",
        "signup_title": "ÕÕ¿Õ¥Õ²Õ®Õ¥Õ¬ Õ°Õ¡Õ·Õ«Õ¾",
        "username_ph": "Õ„Õ¸Ö‚Õ¿Ö„Õ¡Õ£Ö€Õ¥Ö„ Õ¡Õ¶Õ¸Ö‚Õ¶Õ¨",
        "password_ph": "Õ„Õ¸Ö‚Õ¿Ö„Õ¡Õ£Ö€Õ¥Ö„ Õ£Õ¡Õ²Õ¿Õ¶Õ¡Õ¢Õ¡Õ¼Õ¨",
        "login_btn": "Õ„Õ¸Ö‚Õ¿Ö„",
        "signup_btn": "Ô³Ö€Õ¡Õ¶ÖÕ¾Õ¥Õ¬",
        "no_account": "Õ‰Õ¸Ö‚Õ¶Õ¥ÕžÖ„ Õ°Õ¡Õ·Õ«Õ¾:",
        "has_account": "ÕˆÖ‚Õ¶Õ¥ÕžÖ„ Õ°Õ¡Õ·Õ«Õ¾:",
        "lang_select": "Ô¼Õ¥Õ¦Õ¸Ö‚",

        // Sidebar
        "profile_title": "ÕÕ¥Ö€ ÕŠÖ€Õ¸Ö†Õ«Õ¬Õ¨",
        "personality_type": "Ô±Õ¶Õ°Õ¡Õ¿Õ¡Õ¯Õ¡Õ¶Õ¸Ö‚Õ©ÕµÕ¡Õ¶ Õ¿Õ¥Õ½Õ¡Õ¯",
        "analysis": "ÕŽÕ¥Ö€Õ¬Õ¸Ö‚Õ®Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶...",
        "current_level": "Ô¸Õ¶Õ©Õ¡ÖÕ«Õ¯ Õ´Õ¡Õ¯Õ¡Ö€Õ¤Õ¡Õ¯",
        "core_stats": "Õ€Õ«Õ´Õ¶Õ¡Õ¯Õ¡Õ¶ Õ¾Õ«Õ³Õ¡Õ¯Õ¡Õ£Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "dashboard_link": "Ô±Õ¶ÖÕ¶Õ¥Õ¬ Õ¾Õ¡Õ°Õ¡Õ¶Õ¡Õ¯ âžœ",

        // Chat
        "chat_header": "AI Chat RPG",
        "lvl": "Õ„Õ¡Õ¯.",
        "xp": "Õ“Õ¸Ö€Õ±",
        "focus": "Ô¿Õ¥Õ¶Õ¿Ö€.",
        "input_ph": "Õ€Õ¡Ö€ÖÖ€Õ¸Ö‚ Õ«Õ¶Õ± ÖÕ¡Õ¶Õ¯Õ¡ÖÕ¡Õ® Õ¢Õ¡Õ¶...",
        "send": "ÕˆÖ‚Õ²Õ¡Ö€Õ¯Õ¥Õ¬",
        "chat_nav": "Õ‰Õ¡Õ¿",
        "profile_nav": "ÕŠÖ€Õ¸Ö†Õ«Õ¬",
        "dash_nav": "ÕŽÕ¡Õ°Õ¡Õ¶Õ¡Õ¯",
        "logout_nav": "ÔµÕ¬Ö„",
        "initial_greeting": "ÕˆÕ²Õ»Õ¸Ö‚ÕµÕ¶, ÕƒÕ¡Õ¶Õ¡ÕºÕ¡Ö€Õ°Õ¸Ö€Õ¤: ÔµÕ½ Ö„Õ¸ AI Õ¸Ö‚Õ²Õ¥ÖÕ¸Ö‚ÕµÖÕ¶ Õ¥Õ´: Ô½Õ¸Õ½Õ«Ö€ Õ«Õ¶Õ± Õ°Õ¥Õ¿Õ ÖƒÕ¸Ö€Õ± Õ±Õ¥Õ¼Ö„ Õ¢Õ¥Ö€Õ¥Õ¬Õ¸Ö‚, Õ´Õ¡Õ¯Õ¡Ö€Õ¤Õ¡Õ¯Õ¨ Õ¢Õ¡Ö€Õ±Ö€Õ¡ÖÕ¶Õ¥Õ¬Õ¸Ö‚ Ö‡ Ö„Õ¸ Õ¶Õ¥Ö€Õ¸Ö‚ÕªÕ¨ Õ¢Õ¡ÖÕ¡Õ°Õ¡ÕµÕ¿Õ¥Õ¬Õ¸Ö‚ Õ°Õ¡Õ´Õ¡Ö€: ðŸŒŒ",

        // Dashboard
        "dash_title": "ÕŽÕ¡Õ°Õ¡Õ¶Õ¡Õ¯",
        "back_chat": "ÕŽÕ¥Ö€Õ¡Õ¤Õ¡Ö€Õ± Õ‰Õ¡Õ¿",
        "arena_btn": "1v1 Ô±Ö€Õ¥Õ¶Õ¡",
        "traveler": "ÕƒÕ¡Õ¶Õ¡ÕºÕ¡Ö€Õ°Õ¸Ö€Õ¤",
        "streak": "Õ‡Õ¡Ö€Ö„",
        "energy": "Ô·Õ¶Õ¥Ö€Õ£Õ«Õ¡",
        "stats_tab": "ÕŽÕ«Õ³Õ¡Õ¯Õ¡Õ£Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "badges_tab": "Õ†Õ·Õ¡Õ¶Õ¶Õ¥Ö€",
        "quests_tab": "Õ•Ö€Õ¡Õ¯Õ¡Õ¶",
        "weekly_tab": "Õ‡Õ¡Õ¢Õ¡Õ©Õ¡Õ¯Õ¡Õ¶",
        "events_tab": "Ô»Ö€Õ¡Õ¤Õ¡Ö€Õ±.",
        "live_stats": "ÕŽÕ«Õ³Õ¡Õ¯Õ¡Õ£Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "refresh": "Ô¹Õ¡Ö€Õ´Õ¡ÖÕ¶Õ¥Õ¬",

        // Stats
        "health": "Ô±Õ¼Õ¸Õ²Õ»Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "discipline": "Ô¿Õ¡Ö€Õ£Õ¡ÕºÕ¡Õ°Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "productivity": "Ô±Ö€Õ¿Õ¡Õ¤Ö€Õ¸Õ²Õ¡Õ¯Õ¡Õ¶Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "consistency": "Ô¿Õ¡ÕµÕ¸Ö‚Õ¶Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "creativity": "ÕÕ¿Õ¥Õ²Õ®Õ¡Ö€Õ¡Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "kindness": "Ô²Õ¡Ö€Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "awareness": "Ô»Ö€Õ¡Õ¦Õ¥Õ¯Õ¸Ö‚Õ´",

        // Stats Card Headers & Labels
        "current_level_header": "Ô¸Õ¶Õ©Õ¡ÖÕ«Õ¯ Õ´Õ¡Õ¯Õ¡Ö€Õ¤Õ¡Õ¯",
        "hero_title_label": "Ô¿Õ¸Õ¹Õ¸Ö‚Õ´",
        "core_stats_section": "Õ€Õ«Õ´Õ¶Õ¡Õ¯Õ¡Õ¶ Õ¾Õ«Õ³.",
        "activity_section": "Ô±Õ¯Õ¿Õ«Õ¾Õ¸Ö‚Õ©ÕµÕ¸Ö‚Õ¶",
        "next_title": "Õ€Õ¡Õ»Õ¸Ö€Õ¤Õ¨",
        "total_msgs": "Ô¸Õ¶Õ¤Õ°Õ¡Õ¶Õ¸Ö‚Ö€ Õ°Õ¡Õ²Õ¸Ö€Õ¤.",
        "total_xp": "Ô¸Õ¶Õ¤Õ°Õ¡Õ¶Õ¸Ö‚Ö€ XP",

        // Quests & Events
        "reward": "ÕŠÕ¡Ö€Õ£Ö‡",
        "current_potential": "ÕŠÕ¡Ö€Õ£Ö‡",
        "accept_challenge": "Ô¸Õ¶Õ¤Õ¸Ö‚Õ¶Õ¥Õ¬ Õ´Õ¡Ö€Õ¿Õ¡Õ°Ö€Õ¡Õ¾Õ¥Ö€Õ¨",
        "solve": "Ô¼Õ¸Ö‚Õ®Õ¥Õ¬",
        "hint": "Õ€Õ¸Ö‚Õ·Õ¸Ö‚Õ´",
        "hint_deduct": "Õ€Õ¸Ö‚Õ·Õ¸Ö‚Õ´ (-50 XP)",
        "hint_deduct_more": "Õ€Õ¸Ö‚Õ·Õ¸Ö‚Õ´ (-75 XP)",
        "answer_placeholder": "Õ„Õ¸Ö‚Õ¿Ö„Õ¡Õ£Ö€Õ¥Ö„ ÕºÕ¡Õ¿Õ¡Õ½Õ­Õ¡Õ¶Õ¨...",
        "anomaly_cleared": "Ô±Õ¶Õ¸Õ´Õ¡Õ¬Õ«Õ¡Õ¶ Õ¾Õ¥Ö€Õ¡ÖÕ¾Õ¡Õ® Õ§:",
        "incorrect_coordinate": "ÕÕ­Õ¡Õ¬ Õ¯Õ¸Õ¸Ö€Õ¤Õ«Õ¶Õ¡Õ¿: Ô±Õ¦Õ¤Õ¡Õ¶Õ·Õ¡Õ¶Õ¨ Õ¯Õ¸Ö€Õ¡Õ¾:",

        // General
        "loading": "Ô²Õ¥Õ¼Õ¶Õ¾Õ¸Ö‚Õ´ Õ§...",
        "level_up": "Õ†Õ¸Ö€ Õ„Õ¡Õ¯Õ¡Ö€Õ¤Õ¡Õ¯!",
        "claim_rewards": "ÕÕ¿Õ¡Õ¶Õ¡Õ¬ Õ´Ö€ÖÕ¡Õ¶Õ¡Õ¯Õ¶Õ¥Ö€",
        "growing_stronger": "Ô´Õ¸Ö‚ Õ¤Õ¡Õ¼Õ¶Õ¸Ö‚Õ´ Õ¥Õ½ Õ¡Õ¾Õ¥Õ¬Õ« Õ¸Ö‚ÕªÕ¥Õ², ÕƒÕ¡Õ¶Õ¡ÕºÕ¡Ö€Õ°Õ¸Ö€Õ¤:"
    }
};

window.TRANSLATIONS = TRANSLATIONS;

// Shared Helper: Get Translation
window.getTrans = function (key) {
    const state = localStorage.getItem('gameState');
    const lang = state ? (JSON.parse(state).player?.language || 'en') : 'en';
    const t = TRANSLATIONS[lang] || TRANSLATIONS['en'];
    return t[key] || key;
};

// Shared Helper: Apply Language
window.applyLanguage = function (lang) {
    if (!lang) {
        const state = localStorage.getItem('gameState');
        lang = state ? (JSON.parse(state).player?.language || 'en') : 'en';
    }

    // Save to local storage for persistence immediately if passed explicitly
    // (Actual backend sync happens in calling scripts)
    const stateStr = localStorage.getItem('gameState');
    if (stateStr) {
        const state = JSON.parse(stateStr);
        if (state.player && state.player.language !== lang) {
            state.player.language = lang;
            localStorage.setItem('gameState', JSON.stringify(state));
        }
    }

    const t = TRANSLATIONS[lang] || TRANSLATIONS['en'];

    // Apply to static elements
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) el.textContent = t[key];
    });

    // Apply to placeholders
    document.querySelectorAll('[data-i18n-ph]').forEach(el => {
        const key = el.getAttribute('data-i18n-ph');
        if (t[key]) el.placeholder = t[key];
    });

    // Update switcher if it exists
    const switcher = document.getElementById('lang-switcher');
    if (switcher && switcher.value !== lang) {
        switcher.value = lang;
    }

    console.log(`Language applied: ${lang}`);
};

